# Tactical V4 HUD Statusline

Advanced tactical statusline for Claude Code with model aliases, context tracking, and 5-hour window management.

## Overview

The Tactical V4 HUD provides a military-grade statusline interface optimized for Termux/Android environments with real-time context tracking, model identification, and time window management.

## Features

### Model Recognition & Aliases
- **Opus 4.1**: Purple display with "(Nuke)" tactical alias
- **Sonnet 4/3.7**: Cyan display with "(Snipper)" tactical alias  
- **Auto-detection**: Intelligent model identification from JSON payload
- **Color-coded displays**: Visual model differentiation

### Context Tracking
- **Token usage parsing**: Robust extraction from multiple JSON schemas
- **Usage estimation**: Intelligent fallback methods when direct data unavailable
- **Pre-compact display**: Shows remaining context before compression
- **Multiple format support**: Handles k/M suffixes, comma separators, percentages

### 5-Hour Window Management
- **Contiguous blocks**: Time management in 5-hour operational windows
- **Visual progress bar**: Red (used) / Green (remaining) time indication
- **Block labeling**: Shows current block number and time range (HH-HH)
- **Anchor system**: Daily first-message anchor with automatic morning detection

### Git Integration
- **Repository info**: Shows repo/branch with color coding
- **Status indicators**: Dirty (*), staged (+), untracked (?) markers
- **Upstream tracking**: Shows ahead (↑N) / behind (↓N) commit counts
- **Smart coloring**: Green for pending changes, purple/blue for clean state

### Color Palettes
- **Tactical** (default): Military/subdued colors for operational environments
- **Neon**: Bright cyberpunk colors for high-visibility setups  
- **High Contrast**: Accessibility-optimized color scheme

## Installation

```bash
# Copy to your Claude configuration
cp enhanced-tactical-hud-statusline.sh ~/.claude/usage-statusline.sh
chmod +x ~/.claude/usage-statusline.sh

# Set palette mode (optional)
export SEVEN_PALETTE=tactical  # tactical, neon, highcontrast
```

## Usage

The statusline displays a clean 3-line tactical interface:

```
Line 1: ModelBadge(Alias) / ctx pre-compact NNk / [████████░░] NN%
Line 2: user@host :: path/dir - repo/branch*+? ↑N↓M
Line 3: DOW HH:mm | BN HH–HH (5-hour window)
```

### Example Output

```
Sonnet 4 (Snipper) / ctx pre-compact 47k / [██████░░░░] 60%
cody@termux :: seven-of-nine-core/tactical - seven-core/merge-review*+ ↑2
Mon 14:32 | B3 14–19 (5-hour window)
```

## Configuration

### Environment Variables
- `SEVEN_PALETTE`: Color palette (tactical/neon/highcontrast)
- `CLAUDE_FIRST_MSG`: Override first message anchor (epoch timestamp)

### Automatic Features
- **Morning anchor**: Automatically sets daily anchor for messages between 06:00-12:00
- **Fallback detection**: Multiple parsing methods for token usage
- **Termux optimization**: Uses proper directories and fallback commands
- **ANSI handling**: Robust terminal color code rendering

## Technical Details

### Token Usage Parsing
1. **JSON Schema Detection**: Supports multiple Claude Code payload formats
2. **Text Pattern Matching**: Regex patterns for various token display formats
3. **Percentage Estimation**: Fallback calculation from percentage displays
4. **Transcript Analysis**: File-based estimation when other methods fail

### Time Window Logic
- **5-hour blocks**: Contiguous operational time management
- **Block indexing**: Zero-based numbering from daily anchor
- **Progress calculation**: Real-time percentage within current block
- **Visual indicators**: 10-segment progress bar with color coding

### Git Status Integration
- **Repository detection**: Automatic git workspace identification
- **Branch tracking**: Current branch or detached HEAD display
- **Change detection**: Unstaged, staged, and untracked file indicators
- **Upstream analysis**: Remote branch comparison and sync status

## Compatibility

- **Termux/Android**: Optimized for Android development environments
- **Busybox support**: Fallback commands for minimal Linux environments
- **jq integration**: Enhanced JSON parsing when available
- **Terminal support**: Works with xterm-256color and compatible terminals

## Color Schemes

### Tactical (Default)
- Models: Green/Cyan/Gray with Red/Green aliases
- Context: Yellow indicators
- Git: Purple branches, Green pending changes
- Time: Light gray with cyan block labels

### Neon
- High-contrast bright colors for visibility
- Magenta, cyan, bright green emphasis
- Optimal for dark themes and high-DPI displays

### High Contrast  
- Accessibility-focused color selection
- Maximum contrast ratios for readability
- White/yellow primary colors with blue/red accents

Generated by Claude Code (Sonnet 4) for tactical operational environments.
